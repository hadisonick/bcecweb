{"version":3,"sources":["../../../src/components/FileManager/FileManagerContext.tsx"],"names":["React","ListFilesSort","init","accept","showingFileDetails","selected","hasPreviouslyUploadedFiles","queryParams","types","limit","sort","CREATED_ON_DESC","fileManagerReducer","state","action","next","type","existingIndex","findIndex","item","src","file","push","splice","dragging","uploading","FileManagerContext","createContext","FileManagerProvider","children","props","useReducer","dispatch","value","useMemo","useFileManager","context","useContext","Error","toggleSelected","setHasPreviouslyUploadedFiles","setQueryParams","setDragging","setUploading","showFileDetails","hideFileDetails"],"mappings":"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","sourcesContent":["import React from \"react\";\n\nenum ListFilesSort {\n    CREATED_ON_ASC,\n    CREATED_ON_DESC,\n    SIZE_ASC,\n    SIZE_DESC\n}\n\nfunction init({ accept }) {\n    return {\n        showingFileDetails: null,\n        selected: [],\n        hasPreviouslyUploadedFiles: null,\n        queryParams: {\n            types: accept,\n            limit: 50,\n            sort: ListFilesSort.CREATED_ON_DESC\n        }\n    };\n}\n\nfunction fileManagerReducer(state, action) {\n    const next = { ...state };\n    switch (action.type) {\n        case \"toggleSelected\": {\n            const existingIndex = state.selected.findIndex(item => item.src === action.file.src);\n            if (existingIndex < 0) {\n                next.selected.push(action.file);\n            } else {\n                next.selected.splice(existingIndex, 1);\n            }\n            break;\n        }\n        case \"queryParams\": {\n            next.selected = [];\n            next.queryParams = {\n                ...state.queryParams,\n                ...action.queryParams,\n                types: state.queryParams.types,\n                limit: 40,\n                sort: ListFilesSort.CREATED_ON_DESC\n            };\n            break;\n        }\n        case \"showFileDetails\": {\n            next.showingFileDetails = action.src;\n            break;\n        }\n        case \"dragging\": {\n            next.dragging = action.state;\n            break;\n        }\n        case \"hasPreviouslyUploadedFiles\": {\n            next.hasPreviouslyUploadedFiles = action.hasPreviouslyUploadedFiles;\n            break;\n        }\n        case \"uploading\": {\n            next.uploading = action.state;\n            break;\n        }\n    }\n\n    return next;\n}\n\nconst FileManagerContext = React.createContext({});\n\nfunction FileManagerProvider({ children, ...props }) {\n    const [state, dispatch] = React.useReducer(fileManagerReducer, props, init);\n\n    const value = React.useMemo(() => {\n        return {\n            state,\n            dispatch\n        };\n    }, [state]);\n\n    return (\n        <FileManagerContext.Provider value={value} {...props}>\n            {children}\n        </FileManagerContext.Provider>\n    );\n}\n\nfunction useFileManager() {\n    const context: any = React.useContext(FileManagerContext);\n    if (!context) {\n        throw new Error(\"useFileManager must be used within a FileManagerProvider\");\n    }\n\n    const { state, dispatch } = context;\n    return {\n        selected: state.selected,\n        toggleSelected(file) {\n            dispatch({\n                type: \"toggleSelected\",\n                file\n            });\n        },\n        hasPreviouslyUploadedFiles: state.hasPreviouslyUploadedFiles,\n        setHasPreviouslyUploadedFiles(hasPreviouslyUploadedFiles) {\n            dispatch({ type: \"hasPreviouslyUploadedFiles\", hasPreviouslyUploadedFiles });\n        },\n        queryParams: state.queryParams,\n        setQueryParams(queryParams) {\n            dispatch({ type: \"queryParams\", queryParams });\n        },\n        setDragging(state = true) {\n            dispatch({\n                type: \"dragging\",\n                state\n            });\n        },\n        dragging: state.dragging,\n        setUploading(state = true) {\n            dispatch({\n                type: \"uploading\",\n                state\n            });\n        },\n        uploading: state.uploading,\n        showFileDetails(src) {\n            dispatch({ type: \"showFileDetails\", src });\n        },\n        hideFileDetails() {\n            dispatch({ type: \"showFileDetails\", src: null });\n        },\n        showingFileDetails: state.showingFileDetails,\n        state,\n        dispatch\n    };\n}\n\nexport { FileManagerProvider, useFileManager };\n"],"file":"FileManagerContext.js"}